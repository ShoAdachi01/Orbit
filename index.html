<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Orbit - Veo Pipeline</title>
  <link rel="stylesheet" href="/src/styles.css">
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <div>
        <div class="brand">Orbit</div>
        <div class="subtitle">Upload a clip, set a camera, preview with Nano Banana, generate with Veo 3.1.</div>
      </div>
      <div id="status-pill" class="status-pill" data-state="idle">Idle</div>
    </header>

    <nav class="step-nav" aria-label="Pipeline steps">
      <button class="step-chip" data-step="upload" aria-current="step">1 Upload</button>
      <button class="step-chip" data-step="camera">2 Camera</button>
      <button class="step-chip" data-step="results">3 Results</button>
    </nav>

    <div id="error-message" class="error-message hidden"></div>

    <main class="app-main">
      <section class="step" data-step-panel="upload">
        <div class="step-header">
          <div>
            <div class="step-title">Upload your clip</div>
            <div class="step-subtitle">Choose orientation, segment window, and snapshot time before continuing.</div>
          </div>
        </div>

        <div class="step-grid">
          <div class="card">
            <div id="upload-zone" class="upload-zone">
              <div class="upload-text">Drop video here or click to browse</div>
              <div class="upload-hint">MP4, MOV, WebM recommended</div>
            </div>
            <input type="file" id="file-input" accept="video/*" class="hidden">

            <div class="file-meta" id="file-meta">No file selected</div>

            <div class="control-row" style="margin-top: 16px;">
              <div>
                <div class="control-label">Orientation</div>
                <div class="toggle-group" id="orientation-toggle">
                  <button class="toggle" data-orientation="horizontal">Horizontal</button>
                  <button class="toggle" data-orientation="vertical">Vertical</button>
                </div>
              </div>
            </div>

            <div class="control" style="margin-top: 16px;">
              <div class="control-label">Segment start</div>
              <div class="control-value" id="segment-start-value">0.0s</div>
              <input type="range" id="segment-start-slider" min="0" max="10" step="0.1" value="0">
            </div>

            <div class="control">
              <div class="control-label">Segment end</div>
              <div class="control-value" id="segment-end-value">10.0s</div>
              <input type="range" id="segment-end-slider" min="0" max="10" step="0.1" value="10">
            </div>

            <div class="control-row">
              <div class="control-label">Segment length</div>
              <div class="control-value" id="segment-length-value">10.0s</div>
            </div>

            <div class="control" style="margin-top: 16px;">
              <div class="control-label">Snapshot time</div>
              <div class="control-value" id="snapshot-value">1.0s</div>
              <input type="range" id="snapshot-slider" min="0" max="10" step="0.1" value="1">
            </div>

            <div id="upload-progress" class="progress-group hidden">
              <div class="progress-bar">
                <div id="upload-progress-fill" class="progress-fill"></div>
              </div>
              <div id="upload-status-text" class="progress-text">Uploading...</div>
            </div>

            <div class="actions">
              <button id="continue-btn" class="btn" disabled>Continue to camera</button>
            </div>
          </div>

          <div class="card muted-card">
            <div class="card-title">What happens next</div>
            <ul class="note-list">
              <li>We extract a snapshot from your clip.</li>
              <li>SAM 3D Body builds a rough 3D proxy.</li>
              <li>Nano Banana previews the new angle.</li>
              <li>Veo 3.1 generates the final video.</li>
            </ul>
          </div>
        </div>
      </section>

      <section class="step hidden" data-step-panel="camera">
        <div class="step-header">
          <div>
            <div class="step-title">Place the camera</div>
            <div class="step-subtitle">Click the preview to set the camera. Adjust sliders for fine control.</div>
          </div>
          <div class="badge" id="orientation-badge">Horizontal</div>
        </div>

        <div class="step-grid camera-grid">
          <div class="card camera-card">
            <div class="canvas-shell" id="canvas-shell">
              <canvas id="orbit-canvas"></canvas>
              <div id="canvas-overlay" class="canvas-overlay">
                <div id="overlay-title" class="overlay-title">Click to place the camera</div>
                <div id="overlay-sub" class="overlay-sub">We will generate a preview from this angle.</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-title">Camera controls</div>
            <div class="control">
              <label for="yaw-slider">Yaw</label>
              <div class="control-value" id="yaw-value">0.0 deg</div>
              <input type="range" id="yaw-slider" min="-20" max="20" value="0">
            </div>
            <div class="control">
              <label for="pitch-slider">Pitch</label>
              <div class="control-value" id="pitch-value">0.0 deg</div>
              <input type="range" id="pitch-slider" min="-10" max="10" value="0">
            </div>
            <div class="control">
              <label for="roll-slider">Roll</label>
              <div class="control-value" id="roll-value">0.0 deg</div>
              <input type="range" id="roll-slider" min="-3" max="3" value="0" step="0.1">
            </div>
            <div class="control">
              <label for="distance-slider">Distance</label>
              <div class="control-value" id="distance-value">5.0</div>
              <input type="range" id="distance-slider" min="1" max="10" value="5" step="0.1">
            </div>

            <div class="progress-group hidden" id="pipeline-progress">
              <div class="progress-bar">
                <div id="pipeline-progress-fill" class="progress-fill"></div>
              </div>
              <div id="pipeline-status-text" class="progress-text">Processing...</div>
            </div>

            <ol class="stage-list" id="stage-list">
              <li data-stage="upload">Upload</li>
              <li data-stage="snapshot">Snapshot</li>
              <li data-stage="reconstruction">3D reconstruction</li>
              <li data-stage="preview-generation">Preview still</li>
              <li data-stage="veo-generation">Veo video</li>
            </ol>

            <div class="actions">
              <button id="back-btn" class="btn secondary">Back to upload</button>
              <button id="generate-btn" class="btn">Generate preview</button>
            </div>
          </div>
        </div>
      </section>

      <section class="step hidden" data-step-panel="results">
        <div class="step-header">
          <div>
            <div class="step-title">Preview and output</div>
            <div class="step-subtitle">Review the preview still and final Veo output.</div>
          </div>
        </div>

        <div class="step-grid results-grid">
          <div class="card">
            <div class="card-title">Snapshot</div>
            <div class="media-box">
              <img id="snapshot-image" alt="Snapshot preview" class="hidden">
              <div id="snapshot-placeholder" class="media-placeholder">Snapshot will appear here.</div>
            </div>
          </div>
          <div class="card">
            <div class="card-title">Preview still</div>
            <div class="media-box">
              <img id="preview-image" alt="Preview still" class="hidden">
              <div id="preview-placeholder" class="media-placeholder">Preview still will appear here.</div>
            </div>
          </div>
          <div class="card">
            <div class="card-title">Veo output</div>
            <div class="media-box">
              <video id="veo-video" controls class="hidden"></video>
              <div id="video-placeholder" class="media-placeholder">Generated video will appear here.</div>
            </div>
            <div class="actions">
              <a id="download-btn" class="btn" href="#" download aria-disabled="true">Download video</a>
              <a id="reconstruction-link" class="link hidden" href="#" target="_blank" rel="noreferrer">3D asset</a>
            </div>
          </div>
        </div>

        <div class="actions">
          <button id="adjust-camera-btn" class="btn secondary">Adjust camera</button>
          <button id="start-over-btn" class="btn secondary">Start over</button>
        </div>
      </section>
    </main>
  </div>

  <script type="module" src="/src/main.ts"></script>
</body>
</html>
